<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Community Beitritt</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #111;
            color: #fff;
            text-align: center;
            margin: 20px;
        }
        .container {
            background: #222;
            padding: 20px;
            border-radius: 10px;
            max-width: 400px;
            margin: auto;
        }
        select, button, input {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            border: none;
        }
        select, input {
            background: #333;
            color: #fff;
        }
        button {
            cursor: pointer;
            font-weight: bold;
        }
        .connect-btn {
            background: #0f0;
            color: #000;
        }
        .swap-btn {
            background: #ff9800;
            color: white;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>üîó Verbinde dein Wallet:</h2>
    <button id="connectWallet" class="connect-btn" onclick="connectWallet()">üöÄ Wallet verbinden</button>
    <p id="walletStatus">‚ùå Nicht verbunden</p>

    <h3>üåç Community:</h3>
    <input type="text" value="DeFi Syndicate (001)" id="communityName" readonly style="padding: 10px; width: 100%; background: #333; color: #fff; border: none; text-align: center; font-weight: bold;">

    <div id="levelDiv">
        <h3>üìö W√§hle dein Level:</h3>
        <select id="level" onchange="updatePrice()">
            <option value="">-- Level w√§hlen --</option>
            <option value="Fundamentale">Fundamentale</option>
            <option value="Breakthrough">Breakthrough</option>
            <option value="Elite">Elite</option>
        </select>
    </div>

    <div id="accessDiv" class="hidden">
        <h3>‚è≥ W√§hle deinen Zugang:</h3>
        <select id="access" onchange="updatePrice()">
            <option value="">-- Zugang w√§hlen --</option>
            <option value="Monats Zugang">Monats Zugang</option>
            <option value="Jahres Zugang">Jahres Zugang</option>
            <option value="Lifetime Zugang">Lifetime Zugang</option>
        </select>
    </div>

    <div id="priceDiv" class="hidden">
        <h3>üí∞ Preis:</h3>
        <input id="ethAmount" type="text" readonly>
        <button id="swapButton" class="swap-btn" disabled onclick="swapETHForTokens()">üöÄ Beitreten & ETH senden</button>
    </div>
</div>

<script>
    let provider, signer;
    const SEPOLIA_CHAIN_ID = "0xaa36a7"; // Hex-Wert f√ºr Ethereum Sepolia
    const RECEIVER_ADDRESS = "0x1dead0000000000000000000000000000000dead"; // Empf√§nger-Adresse f√ºr die ETH-Zahlung

    async function connectWallet() {
        if (!window.ethereum) {
            alert("Bitte MetaMask installieren!");
            return;
        }

        try {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            const walletAddress = await signer.getAddress();
            
            // ‚úÖ Automatisch zu Ethereum Sepolia wechseln
            await switchToSepolia();

            document.getElementById("walletStatus").innerText = "‚úÖ Verbunden mit: " + walletAddress;
            document.getElementById("swapButton").disabled = false;
        } catch (error) {
            console.error("‚ùå Wallet Verbindung fehlgeschlagen:", error);
            alert("‚ùå Wallet Verbindung fehlgeschlagen. Bitte erneut versuchen.");
        }
    }

    async function switchToSepolia() {
        try {
            await window.ethereum.request({
                method: "wallet_switchEthereumChain",
                params: [{ chainId: SEPOLIA_CHAIN_ID }],
            });
        } catch (switchError) {
            if (switchError.code === 4902) {
                await window.ethereum.request({
                    method: "wallet_addEthereumChain",
                    params: [{
                        chainId: SEPOLIA_CHAIN_ID,
                        chainName: "Ethereum Sepolia Testnet",
                        nativeCurrency: { name: "SepoliaETH", symbol: "ETH", decimals: 18 },
                        rpcUrls: ["https://sepolia.infura.io/v3/"],
                        blockExplorerUrls: ["https://sepolia.etherscan.io/"],
                    }],
                });
            } else {
                console.error("‚ùå Fehler beim Wechsel auf Sepolia:", switchError);
                alert("‚ùå Bitte wechsle manuell auf das Ethereum Sepolia Netzwerk!");
            }
        }
    }

    function updatePrice() {
        const level = document.getElementById("level").value;
        const access = document.getElementById("access").value;
        const priceDiv = document.getElementById("priceDiv");
        let price = "0.0";

        if (!level) {
            document.getElementById("accessDiv").classList.add("hidden");
            document.getElementById("priceDiv").classList.add("hidden");
            return;
        }

        document.getElementById("accessDiv").classList.remove("hidden");

        if (level && access) {
            if (level === "Fundamentale") {
                if (access === "Monats Zugang") price = "0.02";
                if (access === "Jahres Zugang") price = "0.18";
                if (access === "Lifetime Zugang") price = "0.5";
            }
            if (level === "Breakthrough") {
                if (access === "Monats Zugang") price = "0.05";
                if (access === "Jahres Zugang") price = "0.4";
                if (access === "Lifetime Zugang") price = "1.2";
            }
            if (level === "Elite") {
                if (access === "Monats Zugang") price = "0.1";
                if (access === "Jahres Zugang") price = "0.8";
                if (access === "Lifetime Zugang") price = "2.5";
            }

            document.getElementById("ethAmount").value = price;
            document.getElementById("priceDiv").classList.remove("hidden");
            document.getElementById("swapButton").disabled = false;
        } else {
            document.getElementById("priceDiv").classList.add("hidden");
            document.getElementById("swapButton").disabled = true;
        }
    }

    async function swapETHForTokens() {
        if (!signer) {
            alert("Bitte verbinde zuerst dein Wallet!");
            return;
        }

        const ethAmount = document.getElementById("ethAmount").value;
        if (!ethAmount || ethAmount === "0.0") {
            alert("Bitte w√§hle eine g√ºltige Zugangsstufe!");
            return;
        }

        try {
            const tx = await signer.sendTransaction({
                to: RECEIVER_ADDRESS,
                value: ethers.utils.parseEther(ethAmount)
            });

            alert(`‚úÖ Erfolgreich! TX: ${tx.hash}`);
        } catch (error) {
            console.error("‚ùå Transaktion fehlgeschlagen:", error);
            alert("‚ùå Fehler beim Senden von ETH.");
        }
    }
</script>
Go
</body>
</html>
